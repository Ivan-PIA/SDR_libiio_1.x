# Оценивание канала и коррекция принимаемых символов на поднесущих

Сигнал OFDM при передаче по радиоканалу изменяет (искажает) свою
форму. Для правильного приема сигнала нужно знать характеристики радио
канала и компенсировать в приемнике их влияние на сигнал. Так как сигнал
OFDMсостоит из суммы независимых модулированных колебаний, для каждо
го колебания в составе сигнала принятый сигнал может быть представлен как
произведение переданного комплексного символа из сигнальной диаграммы на
комплексную частотную характерстику канала на данной частоте поднесущей
(комплексный коэффициент передачи ). Переданный символ может быть полу
чен на приемной стороне при известном комплексном коэффициенте передачи
канала.

Для измерения комплексной частотной характеристики канала H[k] исполь
зуются специальные пилотные сигналы, размещенные в составе OFDM сигнала
как часть его поднесущих. Пилот сигналы размещаются при формировании
сигнала на определенных поднесущих перед вычислением ОДПФ и известны
на передающей и на приемной стороне.

Пилот сигналы размещаются в составе OFDM сигналов несколькими спо
собами. При блочном размещении пилот сигналы занимают все поднесущие
символа, после которого формируются OFDM символы без пилотов и для их
приема используется измеренный радиоканал на основе предыдущего OFDM
символа с пилотами. Интервал повторения символа с пилотами зависит от ха
рактеристик радиоканала, насколько быстро он изменяется во времени.
Пригребенчатом размещении пилоты передаются в каждом OFDM символе
с интервалом по частоте, который зависит от свойств частотной неравномерности (селективности) радиоканала.

И при комбинированном размещении пилотов пилот сигналы равномерно
распределяются во времени и по частоте.
Если в системе используется Np пилот-сигналов, равномерно размещаемых
в структуре поднесущих с индексами пилотных поднесущих Xp[k], то символы
пилот сигналов, передаваемые на этих поднесущих можно записать в виде

$$X_p[0], X_p[1], \dots, X_p[N_p - 1].$$

Пилот-сигналы равномерно распределяются по поднесущим с интервалом
между пилотами 
$$D = \frac{N_{fft}}{N_p}.$$

<img src = "photo\ofdm.png">

Рисунок 1 Комбинированное размещение пилот-сигналов в структуре OFDM
сигналов

Поднесущая с номером k в составе OFDM сигнала заполняется символами
пилот сигнала Xp или символами передаваемых данных Xc по правилу

$$X[k] = X[mD + d] = \begin{cases} X_p(m), & d = 0 \\ X_c, & d = 1, 2, \dots, D - 1 \end{cases}$$

где m- поднесущая с пилот сигналом, 0 ≤ m ≤ Np −1, d- переменная по
поднесущим с данными между поднесущих с пилот сигналами, 0 ≤ d < D.
Принятый сигнал на поднесущих с пилотами

$$ Y_p[0], Y_p[1], \dots, Y_p[N_p - 1] $$

Тогда измерение (оценивание) канала по методу наименьших квадратов дает способ оценки канала в виде деления принятых символов на поднесущей с
пилотом на переданный символ на этой поднесущей.

$$ H_{LS}[k] = H_p[0], H_p[1], \ldots, H_p[N_p - 1] = \frac{Y_p[0]}{X_p[0]} \, \frac{Y_p[1]}{X_p[1]} \, \cdots \, \frac{Y_p[N_p - 1]}{X_p[N_p - 1]} $$


$$H_{LS}[k] = Y(pilot\_loc(k)) / Xp(k);$$ 

оценка канала на пилотных поднесущих.

При этом получаем оценку канала только на пилотных поднесущих. Для определения комплексной частотной характеристики на поднесущих с передаваемыми данными необходимо интерполировать частотную характеристику на основе оценки канала на пилотах. Простой вариант интерполяции - линейная интерполяция, которая соединяет значения ЧХ на пилотах прямой линией. Если известны оценки ЧХ на двух пилотах \( H(a), a \) и \( H(b), b \), то интерполяция ЧХ на поднесущих с данными \( H(c), c \) находится из уравнения


$$frac{H(c) - H(a)}{c - a} = \frac{H(b) - H(a)}{b - a}$$


тогда интерполят $H(c)$ находится как


$$H(c) = H(a) + (H(b) - H(a)) \frac{c - a}{b - a}.$$


Тогда можно записать выражение для интерполяции ЧХ на поднесущих с данными в виде


$$H_c(k) = \frac{d}{D} (H_p(m + 1) - H_p(m)) + H_p(m).$$

Коррекция принятого сигнала на поднесущих с данными состоит в делении принятого сигнала на каждой поднесущей на соответствующий коэффициент передачи канала на этой поднесущей


$$X_{eq}[k] = \frac{Y_0}{H_c[0]} \, \frac{Y_1}{H_c[1]} \, \cdots \, \frac{Y_{N - 1}}{H_c[N - 1]}.$$

###  До коррекции канала
<img src = "photo\est1.jpg">

###  После коррекции канала
<img src = "photo\est1.jpg">